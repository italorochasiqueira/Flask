{% extends "base.html" %}

{% block title %}E-mail{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/style_email.css') }}">
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

{% endblock %}

{% block content %}
<h2>
    <i class="bi bi-envelope-at"></i>
    E-mail 
</h2>

<section class="email-page">
    <form method="post">
        <fieldset>
            <legend> 
                <i class="bi bi-card-text"></i>
                Conteúdo
            </legend>

            <div class="editor-container" id="editor-container">{{ conteudo_email|safe }}</div>
        </fieldset>

        <div class="acoes-form">
            <button type="button" class="btn-limpar">
                <i class="bi bi-eraser"></i>
                Limpar
            </button>
            <button type="submit" class="btn-salvar">
                <i class="bi bi-floppy"></i>
                Salvar
            </button>
        </div>
    </form>
</section>

<script src="{{ url_for('static', filename='js/pag_email.js') }}"></script>
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script>
    // Inicializa o editor
    var quill = new Quill('#editor-container', {
        theme: 'snow',
        modules: {
            toolbar: [
                ['bold', 'italic', 'underline'],
                [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                ['link']
            ]
        }
    });

    // Limpar conteúdo
    document.querySelector(".btn-limpar").addEventListener("click", () => {
        quill.setText('');
    });

    // Antes de enviar o formulário, coloca o conteúdo HTML em um input hidden
    document.querySelector("form").addEventListener("submit", function(e){
        var input = document.createElement("input");
        input.setAttribute("type", "hidden");
        input.setAttribute("name", "conteudo_email");
        input.value = quill.root.innerHTML;
        this.appendChild(input);
    });
</script>
{% endblock %}